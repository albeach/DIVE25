{
  "version": "7.0.0",
  "sites": [
    {
      "id": 1,
      "name": "DIVE25 API",
      "targets": ["https://dive25-api:3000"],
      "secure": true,
      "trustedCertificateGroupId": 1,
      "sendPaCookie": true,
      "useTargetHostHeader": false,
      "keepAliveTimeout": 0,
      "maxConnections": -1,
      "maxWebSocketConnections": -1,
      "siteAuthenticatorIds": [],
      "skipHostnameVerification": false,
      "expectedHostname": null,
      "availabilityProfileId": 1,
      "loadBalancingStrategyId": 0
    }
  ],
  "applications": [
    {
      "id": 1,
      "name": "DIVE25 Document Access",
      "description": "NATO Document Access System",
      "enabled": true,
      "siteId": 1,
      "virtualHostIds": [1],
      "identityMappingIds": {
        "Web": 1,
        "API": 1
      },
      "contextRoot": "/",
      "caseSensitive": false,
      "policy": {
        "Web": {
          "type": "OAuth"
        },
        "API": {
          "type": "OAuth"
        }
      },
      "resourcePatterns": [
        {
          "id": 1,
          "name": "Document Access",
          "pathPatterns": [
            {
              "pattern": "/api/documents/*",
              "type": "WILDCARD"
            }
          ],
          "pathPrefixes": [
            "/api/documents/"
          ],
          "auditLevel": "ON",
          "unprotected": false,
          "anonymous": false,
          "enabled": true,
          "methods": ["*"],
          "queryParamConfig": {
            "queryParameters": {}
          },
          "resourceType": "Standard",
          "resourceTypeConfiguration": {
            "responseGenerator": null
          },
          "policy": [
            {
              "type": "RuleSet",
              "id": 1
            }
          ]
        }
      ]
    }
  ],
  "rules": [
    {
      "className": "com.pingidentity.pa.policy.ClearanceMatchingRule",
      "id": 1,
      "name": "NATO Clearance Rule",
      "supportedDestinations": ["Site", "Agent"],
      "configuration": {
        "clearanceLevels": {
          "UNCLASSIFIED": 0,
          "NATO RESTRICTED": 1,
          "NATO CONFIDENTIAL": 2,
          "NATO SECRET": 3,
          "COSMIC TOP SECRET": 4
        },
        "attributeName": "clearance"
      }
    },
    {
      "className": "com.pingidentity.pa.policy.CountryOfAffiliationRule",
      "id": 2,
      "name": "NATO Country Rule",
      "configuration": {
        "allowedCountries": [
          "USA", "GBR", "FRA", "DEU", "ITA", "CAN"
        ],
        "attributeName": "countryOfAffiliation"
      }
    }
  ],
  "authTokenManagement": {
    "keyRollEnabled": true,
    "keyRollPeriodInHours": 24,
    "issuer": "PingAccess",
    "signingAlgorithm": "RS256"
  },
  "webSessions": {
    "keyRollEnabled": true,
    "keyRollPeriodInHours": 24,
    "sessionStateCookieName": "PA_SESSION",
    "sessionTimeout": 1800,
    "httpOnlyCookie": true,
    "secureCookie": true,
    "sameSite": "LAX"
  },
  "virtualHosts": [
    {
      "id": 1,
      "host": "dive25.local",
      "port": 443,
      "secure": true,
      "trustedCertificateGroupId": 0
    }
  ]
}